### 인증과 인가 

#### 1. 인증(Authentication)
- 인증은 사용자가 누구인지 **확인하는 과정**이다.
- 예시: 사용자명과 비밀번호를 입력해 서버에 신원을 증명한다.
- 세션과 JWT 모두 처음에 인증 과정을 거친 후, 세션 ID나 JWT를 발급받게 된다.

#### 2. 인가(Authorization)
- 인가는 인증된 사용자가 특정 리소스나 행동을 할 **권한이 있는지 확인하는 과정**이다.
- 예시: 인증된 사용자가 관리 페이지에 접근할 수 있는지 확인한다.

<br/>

### 세션 기반 인증과 인가

#### 1. 세션(Session)
- 세션은 **서버에 사용자의 상태(state)를 저장**하는 방식이다.
- 인증에 성공하면 서버는 **세션 ID**를 클라이언트에게 발급한다.
- 클라이언트는 **세션 ID**를 쿠키에 저장하고, 요청마다 서버에 세션 ID를 전송한다.
- 서버는 세션 ID를 통해 **서버에 저장된 세션 데이터(권한 정보)** 를 찾아 인가를 처리한다.

#### 2. 세션 방식의 특징
- **보안성**: 중요한 정보는 서버에 저장되므로 클라이언트에서 유출될 위험이 적다.
- **서버 부하**: 많은 세션을 관리해야 하므로 서버 리소스 사용량이 증가할 수 있다.
- **확장성 문제**: 서버가 여러 대일 경우, 세션 동기화가 필요하다.

<br/>

### JWT 기반 인증과 인가

#### 1. JWT(Json Web Token)
- JWT는 **사용자의 상태를 클라이언트가 직접 관리**하는 방식이다.
- 인증에 성공하면 서버는 사용자 정보를 포함한 **JWT**를 클라이언트에게 발급한다.
- 클라이언트는 JWT를 저장(예: 로컬 스토리지, 쿠키)하고, 요청마다 서버에 JWT를 전송한다.
- 서버는 JWT를 **검증**하여, 토큰에 포함된 정보로 인가를 처리한다.

#### 2. JWT 방식의 특징
- **스테이트리스(stateless)**: 서버에 세션 정보를 저장하지 않으므로, 서버 부담이 적다.
- **확장성**: 여러 서버에서도 쉽게 검증할 수 있어 확장성이 뛰어나다.
- **보안 문제**: JWT는 클라이언트에 저장되기 때문에 탈취되면 무효화할 수 없으며, 만료 시간 설정 및 리프레시 토큰과 같은 추가적인 보안 조치가 필요하다.

<br/>

### 세션과 JWT 비교

| 구분      | 세션(Session)                              | JWT(Json Web Token)                        |
| --------- | ------------------------------------------ | ------------------------------------------ |
| 상태 관리 | 서버에 저장                                | 클라이언트가 직접 보유                     |
| 확장성    | 서버 확장 시 세션 동기화 필요               | 서버 확장에 유리                          |
| 보안성    | 서버에 중요한 정보가 저장되어 상대적으로 안전 | 클라이언트에 저장되므로 탈취 시 위험 있음  |
| 서버 부담 | 서버에 세션 저장으로 인한 부하 발생        | 스테이트리스 방식으로 서버 부담 적음       |
| 만료      | 서버에서 세션을 무효화할 수 있음           | JWT는 발급 후 만료 시간까지 유효           |

<img src="https://github.com/user-attachments/assets/92efef1b-7361-4205-93fe-43ebf4af0def" width="450">

<br/>

### 세션과 JWT 비교 (수평 확장 관점에서 더 알아보기)

#### 1. 세션 기반 인증 (Session-based Authentication)

- **세션 저장 위치**: 서버 메모리 또는 세션 저장소 (예: Redis, DB)
- **작동 방식**:
  1. 클라이언트가 로그인하면, 서버는 **세션 ID**를 생성하여 클라이언트에 전달.
  2. 서버는 해당 세션 ID와 사용자 정보를 서버 메모리나 저장소에 저장.
  3. 이후 클라이언트는 요청 시 세션 ID를 함께 보내고, 서버는 이를 확인하여 사용자 정보를 처리.
- **수평 확장의 문제**:
  - 서버가 여러 대일 때, 세션 데이터가 각 서버에 분리되어 저장되면 다른 서버에서는 세션 정보를 알 수 없음.
  - 해결책:
    - **세션 공유 저장소** 사용: Redis 또는 데이터베이스를 사용해 여러 서버가 동일한 세션 데이터를 참조.
    - 하지만 트래픽이 많아지면 세션 저장소에 병목이 발생할 수 있음.
    
#### 2. JWT 기반 인증 (JWT-based Authentication)

- **JWT 저장 위치**: 클라이언트 (브라우저의 로컬 스토리지 또는 쿠키)
- **작동 방식**:
  1. 클라이언트가 로그인하면, 서버는 **JWT 토큰**을 생성하여 클라이언트에 전달.
  2. 클라이언트는 JWT를 저장하고, 이후 요청 시 이를 서버에 전달.
  3. 서버는 전달된 JWT를 검증하여 사용자 정보를 확인하고 처리.
- **수평 확장의 장점**:
  - 서버가 JWT 토큰을 따로 저장하지 않으므로 서버가 여러 대일 때도 동일하게 작동.
  - 모든 서버가 토큰만 검증하면 되기 때문에 **확장성**이 뛰어남.
  - 추가적인 세션 저장소나 서버 간 동기화가 필요 없음.



<br/>

### 언제 세션과 JWT를 선택할까?

- **세션을 선택할 때**: 보안이 최우선인 서비스 (예: 금융 서비스)에서 사용하거나, 소규모 서비스에서 사용자가 많지 않은 경우.
- **JWT를 선택할 때**: 확장성과 성능이 중요한 대규모 서비스, 특히 모바일 앱이나 SPA 같은 RESTful API를 사용하는 환경에서 적합하다.
